local raw =
'{state: {range: 372, doorsState: {hood: CLOSED, trunk: CLOSED}, windowsState: {rightRear: CLOSED, combinedState: CLOSED}, roofState: {roofState: CLOSED, roofStateType: SUN_ROOF}, tireState: {frontLeft: {status: {currentPressure: 260, targetPressure: 280}}, frontRight: {status: {currentPressure: 270, targetPressure: 280}}, rearLeft: {status: {currentPressure: 290, targetPressure: 310}}, rearRight: {status: {currentPressure: 290, targetPressure: 310}}}, location: {coordinates: {latitude: 31.158047777777778, longitude: 121.45864083333333}, address: {formatted: 上海市徐汇区云锦路862号星扬西岸中心}, heading: 352, indoorParkingLocation: {currentParkingDistrict: , currentParkingLevel: , currentParkingBuilding: }}, currentMileage: 14984, climateControlState: {activity: INACTIVE}, requiredServices: [], checkControlMessages: [{type: TIRE_PRESSURE, severity: LOW}], chargingProfile: {chargingControlType: WEEKLY_PLANNER, reductionOfChargeCurrent: {start: {hour: 7, minute: 31}, end: {hour: 7, minute: 31}}, chargingMode: IMMEDIATE_CHARGING, chargingPreference: NO_PRESELECTION, departureTimes: [{id: 1, timeStamp: {hour: 10, minute: 0}, action: DEACTIVATE, timerWeekDays: []}, {id: 2, timeStamp: {hour: 14, minute: 0}, action: DEACTIVATE, timerWeekDays: []}, {id: 3, timeStamp: {hour: 18, minute: 50}, action: DEACTIVATE, timerWeekDays: []}, {id: 4, action: DEACTIVATE, timerWeekDays: []}], climatisationOn: true, chargingSettings: {targetSoc: 100, idcc: NO_ACTION, hospitality: NO_ACTION}}, electricChargingState: {chargingLevelPercent: 100, range: 372, isChargerConnected: false, chargingStatus: INVALID, chargingTarget: 100}, combustionFuelLevel: {range: 372}, driverPreferences: {lscPrivacyMode: OFF}, isDeepSleepModeActive: false, climateTimers: [{isWeeklyTimer: false, timerAction: DEACTIVATE, timerWeekDays: [], departureTime: {hour: 7, minute: 0}}, {isWeeklyTimer: true, timerAction: DEACTIVATE, timerWeekDays: [MONDAY], departureTime: {hour: 7, minute: 0}}, {isWeeklyTimer: true, timerAction: DEACTIVATE, timerWeekDays: [MONDAY], departureTime: {hour: 7, minute: 0}}]}, capabilities: {a4aType: NOT_SUPPORTED, climateNow: true, climateFunction: AIR_CONDITIONING, horn: true, isBmwChargingSupported: false, isCarSharingSupported: false, isChargeNowForBusinessSupported: false, isChargingHistorySupported: true, isChargingHospitalityEnabled: false, isChargingLoudnessEnabled: false, isChargingPlanSupported: true, isChargingPowerLimitEnabled: false, isChargingSettingsEnabled: false, isChargingTargetSocEnabled: false, isCustomerEsimSupported: false, isDataPrivacyEnabled: false, isDCSContractManagementSupported: false, isEasyChargeEnabled: true, isMiniChargingSupported: false, isEvGoChargingSupported: false, isRemoteHistoryDeletionSupported: false, isRemoteEngineStartSupported: false, isRemoteServicesActivationRequired: false, isRemoteServicesBookingRequired: false, isScanAndChargeSupported: false, lastStateCallState: ACTIVATED, lights: true, lock: true, remoteSoftwareUpgrade: true, sendPoi: true, unlock: true, vehicleFinder: true, vehicleStateSource: LAST_STATE_CALL, isRemoteHistorySupported: true, isWifiHotspotServiceSupported: false, isNonLscFeatureEnabled: false, isSustainabilitySupported: true, isSustainabilityAccumulatedViewEnabled: true, specialThemeSupport: [], isRemoteParkingSupported: false, remoteChargingCommands: {}, isClimateTimerWeeklyActive: false, digitalKey: {state: ACTIVATED, bookedServicePackage: SMACC_1_5, readerGraphics: 000200000000, vehicleSoftwareUpgradeRequired: false, isDigitalKeyFirstSupported: false}, isPersonalPictureUploadSupported: false, isPlugAndChargeSupported: false, isOptimizedChargingSupported: false}}'

local raw1 =
'{state: {isLeftSteering: true, lastFetched: 2023-09-12T09:53:54.408Z, lastUpdatedAt: 2023-05-30T01:00:15Z}}'

local f = require("lua/json_formatter")
local tokens = f.tokenize(raw)
for index, value in ipairs(tokens) do
	--print(index .. ': ' .. value)
end
f.testFormat(tokens)
